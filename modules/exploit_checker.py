import json

# Load exploit database and check if the plugin has any exploits
def check_local_exploits(found_plugins, db_path="data/exploits_db.json"):
    db = load_exploits_from_db(db_path)
    results = []
    
    for plugin in found_plugins:
        exploit = check_plugin_exploit(plugin, db)
        if exploit:
            results.append({
                "plugin": plugin,
                "exploit": exploit
            })
    return results

def check_plugin_exploit(plugin, db):
    if plugin in db:
        return db[plugin]
    return None

def load_exploits_from_db(db_path="data/exploits_db.json"):
    with open(db_path, "r") as f:
        db = json.load(f)
    return db
